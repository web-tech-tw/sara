import{r,u as y,c as d,o as w,a as V,b as n,t as p,d as j,F as k,f as C}from"./index-9ed4bb42.js";import{_ as B}from"./InputModal-78a93c31.js";const R={class:"flex justify-center my-8 py-16"},S={class:"flex flex-col"},$={class:"input-label text-base mb-2"},q={class:"input-label text-base mb-2 text-red-600"},N={__name:"ManageEmailView",setup(E){const i=r(!1),o=r(""),l=r(""),c=r(""),u=y(),m=C(),v=d(()=>l.value?"請輸入您的轉移代碼：":"請輸入新的電子郵件地址："),f=d(()=>l.value?"例如：12345678":"例如：sara@web-tech.tw"),_=d(()=>l.value?"請於您的新的電子郵件信箱收取轉移代碼。":""),b=()=>{window.history.length?u.back():u.replace("/")},h=async s=>{if(!s){o.value="請輸入資料";return}o.value="",i.value=!0,l.value?await x(s):await g(s),i.value=!1},g=async s=>{var t;try{const a=await(await m.put("users/me/email",{json:{email:s}})).json();a!=null&&a.session_id?(l.value=a.session_id,c.value=""):o.value="發生錯誤 (無錯誤代碼)"}catch(e){const a=((t=e==null?void 0:e.response)==null?void 0:t.status)||"無錯誤代碼";o.value=`發生錯誤 (${a})`,console.error(e.message)}},x=async s=>{var t;try{await m.patch("users/me/email",{json:{session_id:l.value,code:s}}),o.value="修改成功，正在寫入憑證...",c.value="",setTimeout(()=>u.replace("/manage"),500)}catch(e){const a=((t=e==null?void 0:e.response)==null?void 0:t.status)||"無錯誤代碼";o.value=`發生錯誤 (${a})`,console.error(e.message)}};return(s,t)=>(w(),V(k,null,[n("div",R,[n("div",S,[n("label",$,p(v.value),1),n("p",q,p(o.value),1),j(B,{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e),loading:i.value,placeholder:f.value,description:_.value,onSubmit:h},null,8,["modelValue","loading","placeholder","description"])])]),n("div",{class:"flex justify-center mt-5"},[n("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:b}," 取消 ")])],64))}};export{N as default};
