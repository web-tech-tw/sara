import{r as m,c as S,o as V,l as N,a as o,b as a,d as t,t as l,e as r,F as c,m as I,h as C,w as R,n as D,f as v,p as M,k as O}from"./index-0d3eb3fb.js";import{_ as H}from"./ToastModal-ea3c38c1.js";const U={class:"flex justify-center my-8 py-16"},B={key:0,class:"flex flex-col mx-auto"},j={class:"max-w-2xl mx-auto sm:px-6 lg:px-8"},G={key:0,class:"overflow-hidden shadow-md"},L={class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"},F={class:"p-6 bg-white border-b border-gray-200"},K={key:0,class:"p-6 bg-white border-b border-gray-200"},X={class:"list-disc ml-7"},P={key:1,class:"overflow-hidden shadow-md"},$={class:"p-6 bg-white border-b border-gray-200"},q={class:"flex rounded bg-white"},z={class:"p-6 bg-white border-b border-gray-200"},J={key:1},Z={__name:"ManageView",setup(Q){const{VITE_INDEX_INTE_HOST:x,VITE_SARA_TOKEN_NAME:g,VITE_SARA_GUARD_NAME:y}={VITE_INDEX_INTE_HOST:"https://web-tech.tw",VITE_SARA_INTE_HOST:"https://web-tech.tw/sara",VITE_SARA_RECV_HOST:"https://web-tech.tw/recv/sara",VITE_SARA_TOKEN_NAME:"unified_token",VITE_SARA_GUARD_NAME:"guard_token",BASE_URL:"/sara/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},i=m(""),b=m(!1),u=m({nickname:""}),s=m(null),p=O(),_=S(()=>{var n;return Array.isArray((n=s.value)==null?void 0:n.roles)&&s.value.roles.length}),w=()=>{localStorage.removeItem(g),localStorage.removeItem(y),location.replace(x)},k=()=>{i.value="尚未實作"},f=()=>{b.value=!0},h=()=>{b.value=!1},E=async()=>{await p.put("users/me",{json:{nickname:u.value.nickname}}),i.value="修改成功",setTimeout(()=>{location.reload()},1300)};return V(async()=>{try{const e=await(await p.get("users/me")).json();s.value=e.profile,u.value.nickname=e.nickname}catch(n){console.warn(n.message)}}),(n,e)=>{const A=N("router-link");return o(),a(c,null,[t("div",U,[s.value?(o(),a("div",B,[t("div",j,[b.value?(o(),a("div",P,[e[12]||(e[12]=t("div",{class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"}," 修改個人資料： ",-1)),t("div",$,[t("div",q,[e[8]||(e[8]=t("label",{class:"w-20 px-4 py-1 text-gray-600",for:"nickname"},"暱稱：",-1)),R(t("input",{id:"nickname","onUpdate:modelValue":e[0]||(e[0]=d=>u.value.nickname=d),class:"border-none bg-transparent px-4 py-1 text-gray-900 outline-none focus:outline-none",placeholder:"例如：星川 サラ",type:"text"},null,512),[[D,u.value.nickname]])])]),t("div",z,[e[10]||(e[10]=r(" 若要修改電子郵件地址，請點 ")),v(A,{class:"text-amber-900",to:"/manage/email"},{default:M(()=>e[9]||(e[9]=[r(" 此處 ")])),_:1}),e[11]||(e[11]=r(" 。 "))]),t("div",{class:"p-6 bg-white border-gray-200 text-right"},[t("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded mr-3",onClick:E}," 確定修改 "),t("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded",onClick:h}," 取消 ")])])):(o(),a("div",G,[t("div",L," 您好，"+l(s.value.nickname)+"，這裡是您的個人資料： ",1),t("div",F,[e[2]||(e[2]=t("span",{class:"text-gray-600"},"暱稱：",-1)),r(l(s.value.nickname),1),e[3]||(e[3]=t("br",null,null,-1)),e[4]||(e[4]=t("span",{class:"text-gray-600"},"電子郵件地址：",-1)),r(l(s.value.email),1),e[5]||(e[5]=t("br",null,null,-1)),e[6]||(e[6]=t("span",{class:"text-gray-600"},"Sara 系統使用者識別碼：",-1)),r(l(s.value._id),1)]),t("div",{class:"p-6 bg-white border-b border-gray-200 text-right"},[t("button",{class:"bg-amber-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-amber-600 rounded mr-3",onClick:w}," 登出 "),t("button",{class:"bg-red-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-red-600 rounded mr-3",onClick:k}," 刪除帳號 "),t("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded",onClick:f}," 修改個人資料 ")]),_.value?(o(),a("div",K,[e[7]||(e[7]=t("span",{class:"text-gray-600"},"持有權限：",-1)),t("ul",X,[(o(!0),a(c,null,I(s.value.roles,(d,T)=>(o(),a("li",{key:T},l(d),1))),128))])])):C("",!0)]))])])):(o(),a("div",J,l(s.value===null?"載入中...":"發生錯誤"),1))]),v(H,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=d=>i.value=d)},null,8,["modelValue"])],64)}}};export{Z as default};
