import{r,u as H,c as u,o as B,a as y,b as _,d as i,t as M,e as v,f as N,g as R,F as q,h as F,i as K,j as L}from"./index-395a3c98.js";import{_ as P}from"./InputModal-261cdbc1.js";import{_ as U}from"./ToastModal-8587db35.js";const A={class:"flex justify-center my-8 py-16"},D={class:"flex flex-col mx-5"},E={class:"input-label text-base mb-2"},T={class:"flex justify-center mt-5"},g="saraInputHistoryLogin",O={__name:"HomeView",setup(W){const p=r(!1),d=r(""),a=r(""),m=r(""),o=r(""),c=r(""),f=L(),x=H(),h=u(()=>o.value?"請輸入您的登入代碼：":"請輸入您的電子郵件地址："),b=u(()=>o.value?"例如：123456":"例如：sara@web-tech.tw"),w=u(()=>o.value?`請於您的電子郵件信箱 ${m.value} 收取登入代碼。`:""),k=u(()=>o.value?"text":"email"),V=u(()=>o.value?"請輸入登入代碼":"請輸入電子郵件地址"),S=u(()=>!o.value),j=()=>{a.value="尚未實作"},C=async n=>{if(!n){a.value=V.value;return}a.value="",p.value=!0,o.value?await $(n):await I(n),p.value=!1},I=async n=>{var e,s;try{const l=await(await f.post("tokens",{json:{email:n}})).json();l!=null&&l.session_id?(o.value=l.session_id,m.value=c.value,d.value="",c.value=""):a.value="發生錯誤 (無錯誤代碼)"}catch(t){if(((e=t==null?void 0:t.response)==null?void 0:e.status)===404)sessionStorage.setItem("sara_register_email",n),x.push("/register");else{const l=((s=t==null?void 0:t.response)==null?void 0:s.status)||"無錯誤代碼";a.value=`發生錯誤 (${l})`,console.error(t.message)}}},$=async n=>{var e;try{await f.patch("tokens",{json:{session_id:o.value,code:n}}),a.value="登入成功，正在寫入憑證...",localStorage.setItem(g,m.value),F()}catch(s){const t=((e=s==null?void 0:s.response)==null?void 0:e.status)||"無錯誤代碼";a.value=`發生錯誤 (${t})`,console.error(s.message)}};return B(()=>{d.value=localStorage.getItem(g)}),(n,e)=>(y(),_(q,null,[i("div",A,[i("div",D,[i("label",E,M(h.value),1),v(P,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),loading:p.value,placeholder:b.value,description:w.value,"input-type":k.value,"input-history":d.value,onSubmit:C},null,8,["modelValue","loading","placeholder","description","input-type","input-history"])])]),i("div",T,[S.value?(y(),_("button",{key:0,class:"flex items-center space-x-2 bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:j},[i("span",null,[v(N(K),{class:"h-5 w-5"})]),e[2]||(e[2]=i("span",{class:"font-bold"}," Passkey ",-1))])):R("",!0)]),v(U,{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value=s)},null,8,["modelValue"])],64))}};export{O as default};
