import{r as n,u as x,c as d,o as V,a as j,b as r,t as k,d as v,F as $,f as C}from"./index-dba97ea6.js";import{_ as B,a as M}from"./ToastModal-06bfe772.js";const R={class:"flex justify-center my-8 py-16"},S={class:"flex flex-col mx-5"},q={class:"input-label text-base mb-2"},U={__name:"ManageEmailView",setup(E){const c=n(!1),a=n(""),m=n(""),l=n(""),u=n(""),i=x(),p=C(),f=d(()=>l.value?"請輸入您的轉移代碼：":"請輸入新的電子郵件地址："),_=d(()=>l.value?"例如：12345678":"例如：sara@web-tech.tw"),b=d(()=>l.value?`請於您的電子郵件信箱 ${m.value} 收取轉移代碼。`:""),g=()=>{window.history.length?i.back():i.replace("/")},y=async t=>{if(!t){a.value="請輸入資料";return}a.value="",c.value=!0,l.value?await w(t):await h(t),c.value=!1},h=async t=>{var s;try{const o=await(await p.put("users/me/email",{json:{email:t}})).json();o!=null&&o.session_id?(l.value=o.session_id,m.value=u.value,u.value=""):a.value="發生錯誤 (無錯誤代碼)"}catch(e){const o=((s=e==null?void 0:e.response)==null?void 0:s.status)||"無錯誤代碼";a.value=`發生錯誤 (${o})`,console.error(e.message)}},w=async t=>{var s;try{await p.patch("users/me/email",{json:{session_id:l.value,code:t}}),a.value="修改成功，正在寫入憑證...",setTimeout(()=>i.replace("/manage"),500)}catch(e){const o=((s=e==null?void 0:e.response)==null?void 0:s.status)||"無錯誤代碼";a.value=`發生錯誤 (${o})`,console.error(e.message)}};return(t,s)=>(V(),j($,null,[r("div",R,[r("div",S,[r("label",q,k(f.value),1),v(B,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=e=>u.value=e),loading:c.value,placeholder:_.value,description:b.value,onSubmit:y},null,8,["modelValue","loading","placeholder","description"])])]),r("div",{class:"flex justify-center mt-5"},[r("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:g}," 取消 ")]),v(M,{modelValue:a.value,"onUpdate:modelValue":s[1]||(s[1]=e=>a.value=e)},null,8,["modelValue"])],64))}};export{U as default};
