import{r as n,u as w,c as d,o as V,a as k,b as r,t as C,d as v,F as j,h as $}from"./index-d6ff3d95.js";import{_ as B}from"./InputModal-2cfea156.js";import{_ as M}from"./ToastModal-0facbca3.js";const R={class:"flex justify-center my-8 py-16"},S={class:"flex flex-col mx-5"},q={class:"input-label text-base mb-2"},D={__name:"ManageEmailView",setup(E){const u=n(!1),a=n(""),m=n(""),l=n(""),c=n(""),i=w(),p=$(),f=d(()=>l.value?"請輸入您的轉移代碼：":"請輸入新的電子郵件地址："),_=d(()=>l.value?"例如：12345678":"例如：sara@web-tech.tw"),b=d(()=>l.value?`請於您的電子郵件信箱 ${m.value} 收取轉移代碼。`:""),x=()=>{window.history.length?i.back():i.replace("/")},g=async t=>{if(!t){a.value="請輸入資料";return}a.value="",u.value=!0,l.value?await y(t):await h(t),u.value=!1},h=async t=>{var s;try{const o=await(await p.put("users/me/email",{json:{email:t}})).json();o!=null&&o.session_id?(l.value=o.session_id,m.value=c.value,c.value=""):a.value="發生錯誤 (無錯誤代碼)"}catch(e){const o=((s=e==null?void 0:e.response)==null?void 0:s.status)||"無錯誤代碼";a.value=`發生錯誤 (${o})`,console.error(e.message)}},y=async t=>{var s;try{await p.patch("users/me/email",{json:{session_id:l.value,code:t}}),a.value="修改成功，正在寫入憑證...",setTimeout(()=>i.replace("/manage"),500)}catch(e){const o=((s=e==null?void 0:e.response)==null?void 0:s.status)||"無錯誤代碼";a.value=`發生錯誤 (${o})`,console.error(e.message)}};return(t,s)=>(V(),k(j,null,[r("div",R,[r("div",S,[r("label",q,C(f.value),1),v(B,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=e=>c.value=e),loading:u.value,placeholder:_.value,description:b.value,onSubmit:g},null,8,["modelValue","loading","placeholder","description"])])]),r("div",{class:"flex justify-center mt-5"},[r("button",{class:"flex items-center space-x-2 bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:x}," 取消 ")]),v(M,{modelValue:a.value,"onUpdate:modelValue":s[1]||(s[1]=e=>a.value=e)},null,8,["modelValue"])],64))}};export{D as default};
