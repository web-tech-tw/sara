import{r as u,u as j,c as i,o as C,a as $,b as l,t as S,d as p,e as B,F as R,f as q,g as F,h as I}from"./index-2640c8ee.js";import{_ as M}from"./InputModal-7d56d9dd.js";import{_ as N}from"./ToastModal-702c4912.js";const P={class:"flex justify-center my-8 py-16"},U={class:"flex flex-col mx-5"},A={class:"input-label text-base mb-2"},D={class:"flex justify-center mt-5"},W={__name:"HomeView",setup(E){const d=u(!1),a=u(""),m=u(""),n=u(""),c=u(""),v=I(),f=j(),_=i(()=>n.value?"請輸入您的登入代碼：":"請輸入您的電子郵件地址："),y=i(()=>n.value?"例如：123456":"例如：sara@web-tech.tw"),x=i(()=>n.value?`請於您的電子郵件信箱 ${m.value} 收取登入代碼。`:""),g=i(()=>n.value?"text":"email"),b=i(()=>n.value?"請輸入登入代碼":"請輸入電子郵件地址"),h=()=>{a.value="尚未實作"},w=async o=>{if(!o){a.value=b.value;return}a.value="",d.value=!0,n.value?await V(o):await k(o),d.value=!1},k=async o=>{var e,s;try{const r=await(await v.post("tokens",{json:{email:o}})).json();r!=null&&r.session_id?(n.value=r.session_id,m.value=c.value,c.value=""):a.value="發生錯誤 (無錯誤代碼)"}catch(t){if(((e=t==null?void 0:t.response)==null?void 0:e.status)===404)sessionStorage.setItem("sara_register_email",o),f.push("/register");else{const r=((s=t==null?void 0:t.response)==null?void 0:s.status)||"無錯誤代碼";a.value=`發生錯誤 (${r})`,console.error(t.message)}}},V=async o=>{var e;try{await v.patch("tokens",{json:{session_id:n.value,code:o}}),a.value="登入成功，正在寫入憑證...",q()}catch(s){const t=((e=s==null?void 0:s.response)==null?void 0:e.status)||"無錯誤代碼";a.value=`發生錯誤 (${t})`,console.error(s.message)}};return(o,e)=>(C(),$(R,null,[l("div",P,[l("div",U,[l("label",A,S(_.value),1),p(M,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=s=>c.value=s),loading:d.value,placeholder:y.value,description:x.value,"input-type":g.value,onSubmit:w},null,8,["modelValue","loading","placeholder","description","input-type"])])]),l("div",D,[l("button",{class:"flex items-center space-x-2 bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:h},[l("span",null,[p(B(F),{class:"h-5 w-5"})]),e[2]||(e[2]=l("span",{class:"font-bold"}," Passkey ",-1))])]),p(N,{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=s=>a.value=s)},null,8,["modelValue"])],64))}};export{W as default};
