import{r as n,u as V,c,o as k,a as C,b as r,t as j,d as v,F as $,h as B}from"./index-9ed9b1d6.js";import{_ as M}from"./InputModal-dc7765d8.js";import{_ as R}from"./ToastModal-deecaa8d.js";const S={class:"flex justify-center my-8 py-16"},q={class:"flex flex-col mx-5"},E={class:"input-label text-base mb-2"},D={__name:"ManageEmailView",setup(F){const i=n(!1),t=n(""),m=n(""),l=n(""),u=n(""),d=V(),p=B(),f=c(()=>l.value?"請輸入您的轉移代碼：":"請輸入新的電子郵件地址："),_=c(()=>l.value?"例如：12345678":"例如：sara@web-tech.tw"),y=c(()=>l.value?`請於您的電子郵件信箱 ${m.value} 收取轉移代碼。`:""),x=c(()=>l.value?"text":"email"),b=()=>{window.history.length?d.back():d.replace("/")},g=async a=>{if(!a){t.value="請輸入資料";return}t.value="",i.value=!0,l.value?await w(a):await h(a),i.value=!1},h=async a=>{var s;try{const o=await(await p.put("users/me/email",{json:{email:a}})).json();o!=null&&o.session_id?(l.value=o.session_id,m.value=u.value,u.value=""):t.value="發生錯誤 (無錯誤代碼)"}catch(e){const o=((s=e==null?void 0:e.response)==null?void 0:s.status)||"無錯誤代碼";t.value=`發生錯誤 (${o})`,console.error(e.message)}},w=async a=>{var s;try{await p.patch("users/me/email",{json:{session_id:l.value,code:a}}),t.value="修改成功，正在寫入憑證...",setTimeout(()=>d.replace("/manage"),500)}catch(e){const o=((s=e==null?void 0:e.response)==null?void 0:s.status)||"無錯誤代碼";t.value=`發生錯誤 (${o})`,console.error(e.message)}};return(a,s)=>(k(),C($,null,[r("div",S,[r("div",q,[r("label",E,j(f.value),1),v(M,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=e=>u.value=e),loading:i.value,placeholder:_.value,description:y.value,"input-type":x.value,onSubmit:g},null,8,["modelValue","loading","placeholder","description","input-type"])])]),r("div",{class:"flex justify-center mt-5"},[r("button",{class:"flex items-center space-x-2 bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:b}," 取消 ")]),v(R,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=e=>t.value=e)},null,8,["modelValue"])],64))}};export{D as default};
