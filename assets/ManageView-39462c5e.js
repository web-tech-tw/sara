import{r as m,c as T,i as V,j as C,o,a as n,b as t,t as l,k as r,F as p,l as S,m as A,w as I,v as N,d as x,n as R,h as D}from"./index-2640c8ee.js";import{_ as M}from"./ToastModal-702c4912.js";const O={class:"flex justify-center my-8 py-16"},H={key:0,class:"flex flex-col mx-5 md:mx-auto"},j={class:"max-w-2xl mx-auto sm:px-6 lg:px-8"},B={key:0,class:"overflow-hidden shadow-md"},U={class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"},L={class:"p-6 bg-white border-b border-gray-200"},F={key:0,class:"p-6 bg-white border-b border-gray-200"},X={class:"list-disc ml-7"},G={key:1,class:"overflow-hidden shadow-md"},K={class:"p-6 bg-white border-b border-gray-200"},P={class:"flex rounded bg-white"},$={class:"p-6 bg-white border-b border-gray-200"},q={key:1},W={__name:"ManageView",setup(z){const{VITE_INDEX_INTE_HOST:g}={VITE_INDEX_INTE_HOST:"https://web-tech.tw",VITE_SARA_INTE_HOST:"https://web-tech.tw/sara",VITE_SARA_RECV_HOST:"https://web-tech.tw/recv/sara",VITE_SARA_TOKEN_NAME:"unified_token",VITE_SARA_GUARD_NAME:"guard_token",BASE_URL:"/sara/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},i=m(""),b=m(!1),u=m({nickname:""}),s=m(null),c=D(),v=T(()=>{var a;return Array.isArray((a=s.value)==null?void 0:a.roles)&&s.value.roles.length}),y=()=>{localStorage.clear(),location.assign(g)},w=()=>{i.value="尚未實作"},k=()=>{b.value=!0},_=()=>{b.value=!1},f=async()=>{await c.put("users/me",{json:{nickname:u.value.nickname}}),i.value="修改成功",setTimeout(()=>{location.reload()},1300)};return V(async()=>{try{const e=await(await c.get("users/me")).json();s.value=e.profile,u.value.nickname=e.nickname}catch(a){console.warn(a.message)}}),(a,e)=>{const h=C("router-link");return o(),n(p,null,[t("div",O,[s.value?(o(),n("div",H,[t("div",j,[b.value?(o(),n("div",G,[e[12]||(e[12]=t("div",{class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"}," 修改個人資料： ",-1)),t("div",K,[t("div",P,[e[8]||(e[8]=t("label",{class:"px-4 py-1 text-gray-600",for:"nickname"},"暱稱：",-1)),I(t("input",{id:"nickname","onUpdate:modelValue":e[0]||(e[0]=d=>u.value.nickname=d),class:"border-none bg-transparent px-4 py-1 text-gray-900 outline-none focus:outline-none",placeholder:"例如：星川 サラ",type:"text"},null,512),[[N,u.value.nickname]])])]),t("div",$,[e[10]||(e[10]=r(" 若要修改電子郵件地址，請點 ")),x(h,{class:"text-amber-900",to:"/manage/email"},{default:R(()=>e[9]||(e[9]=[r(" 此處 ")])),_:1}),e[11]||(e[11]=r(" 。 "))]),t("div",{class:"p-6 bg-white border-gray-200 text-right"},[t("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded mr-3",onClick:f}," 確定修改 "),t("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded",onClick:_}," 取消 ")])])):(o(),n("div",B,[t("div",U," 您好，"+l(s.value.nickname)+"，這裡是您的個人資料： ",1),t("div",L,[e[2]||(e[2]=t("span",{class:"text-gray-600"},"暱稱：",-1)),r(l(s.value.nickname),1),e[3]||(e[3]=t("br",null,null,-1)),e[4]||(e[4]=t("span",{class:"text-gray-600"},"電子郵件地址：",-1)),r(l(s.value.email),1),e[5]||(e[5]=t("br",null,null,-1)),e[6]||(e[6]=t("span",{class:"text-gray-600"},"Sara系統使用者識別碼：",-1)),r(l(s.value._id),1)]),t("div",{class:"p-6 bg-white border-b border-gray-200 text-right"},[t("button",{class:"bg-amber-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-amber-600 rounded mr-3",onClick:y}," 登出 "),t("button",{class:"bg-red-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-red-600 rounded mr-3",onClick:w}," 刪除帳號 "),t("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded",onClick:k}," 修改個人資料 ")]),v.value?(o(),n("div",F,[e[7]||(e[7]=t("span",{class:"text-gray-600"},"持有權限：",-1)),t("ul",X,[(o(!0),n(p,null,S(s.value.roles,(d,E)=>(o(),n("li",{key:E},l(d),1))),128))])])):A("",!0)]))])])):(o(),n("div",q,l(s.value===null?"載入中...":"發生錯誤"),1))]),x(M,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=d=>i.value=d)},null,8,["modelValue"])],64)}}};export{W as default};
