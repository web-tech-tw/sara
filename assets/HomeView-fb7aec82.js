import{r as a,u as L,c,o as A,a as m,b as p,d as e,e as u,t as v,f as g,g as W,h as f,w as z,v as G,F as J,i as O,j as Q}from"./index-b865481a.js";import{_ as X,u as Y}from"./ToastModal-149c08f7.js";import{_ as Z}from"./InputModal-8efd00d1.js";const ee={key:0},se={class:"flex justify-center my-8 py-16"},te={class:"flex flex-col mx-auto"},oe={class:"max-w-2xl mx-auto sm:px-6 lg:px-8"},ae={class:"overflow-hidden shadow-md"},le={class:"p-6 bg-white border-b border-gray-200"},ne={class:"text-slate-900 my-3"},re={key:1},ie={class:"flex justify-center my-8 py-16"},ue={class:"flex flex-col mx-5"},de={class:"input-label text-base mb-2"},ce={key:0,class:"flex justify-center mt-5"},ve={key:1,class:"flex justify-center mt-5"},me={key:2,class:"text-center text-slate-700 mt-5 text-sm"},pe={class:"text-center text-slate-700 mt-5 text-sm"},h="saraLoginEmailHistory",be="saraRegisterEmail",he={__name:"HomeView",setup(xe){const y=a(!1),_=a(!1),w=a(!0),b=a(""),l=a(""),d=a(""),t=a(""),k=a(""),C=a(""),S=a(""),x=a(""),V=Y(),j=L(),I=c(()=>t.value?"請輸入您的登入代碼：":"請輸入您的電子郵件地址："),H=c(()=>t.value?"例如：123456":"例如：sara@web-tech.tw"),R=c(()=>t.value?`請於您的電子郵件信箱 ${d.value} 收取登入代碼。`:""),E=c(()=>t.value?"text":"email"),$=c(()=>t.value?"請輸入登入代碼":"請輸入電子郵件地址"),D=c(()=>!t.value),N=c(()=>!t.value&&!!b.value),B=c(()=>!!t.value),K=()=>{l.value="尚未實作"},M=()=>{localStorage.removeItem(h),b.value="",l.value="成功清除登入記錄"},P=()=>{sessionStorage.setItem(be,d.value),j.push("/register")},T=()=>{location.reload()},U=async n=>{if(!n){l.value=$.value;return}l.value="",y.value=!0,t.value?await F(n):await q(n),y.value=!1},q=async n=>{var s,o;try{const i=await(await V.post("tokens",{json:{email:n}})).json();i!=null&&i.session_id?(t.value=i.session_id,k.value=i.session_ua,C.value=i.session_ip,S.value=i.session_tm,d.value=n,b.value="",x.value=""):l.value="發生錯誤 (無錯誤代碼)"}catch(r){if(((s=r==null?void 0:r.response)==null?void 0:s.status)===404)d.value=n,w.value=!1,x.value="";else{const i=((o=r==null?void 0:r.response)==null?void 0:o.status)||"無錯誤代碼";l.value=`發生錯誤 (${i})`,console.error(r.message)}}},F=async n=>{var s;try{await V.patch("tokens",{json:{session_id:t.value,code:n}}),_.value=!0,l.value="登入成功，正在寫入憑證...",localStorage.setItem(h,d.value),O()}catch(o){const r=((s=o==null?void 0:o.response)==null?void 0:s.status)||"無錯誤代碼";l.value=`發生錯誤 (${r})`,console.error(o.message)}};return A(()=>{b.value=localStorage.getItem(h)}),(n,s)=>(m(),p(J,null,[w.value?(m(),p("div",re,[e("div",ie,[e("div",ue,[e("label",de,v(I.value),1),g(Z,{modelValue:x.value,"onUpdate:modelValue":s[0]||(s[0]=o=>x.value=o),loading:y.value,done:_.value,placeholder:H.value,description:R.value,"input-type":E.value,"input-history":b.value,onSubmit:U},null,8,["modelValue","loading","done","placeholder","description","input-type","input-history"])])]),D.value?(m(),p("div",ce,[e("button",{class:"flex items-center space-x-2 bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:K},[e("span",null,[g(W(Q),{class:"h-5 w-5"})]),s[7]||(s[7]=e("span",{class:"font-bold"}," Passkey ",-1))])])):f("",!0),N.value?(m(),p("div",ve,[e("button",{class:"flex items-center space-x-2 bg-white-500 text-sm text-black font-bold py-1 md:px-3 px-4 hover:bg-slate-100 rounded mr-3",onClick:M},s[8]||(s[8]=[e("span",{class:"font-bold"}," 清除登入記錄 ",-1)]))])):f("",!0),B.value?(m(),p("div",me,[e("div",null,"申請時間："+v(S.value||"未知"),1),e("div",null,"申請識別碼："+v(t.value||"未知"),1),e("div",null,"申請來源裝置："+v(k.value||"未知"),1),e("div",null,"申請來源 IP 位址："+v(C.value||"未知"),1)])):f("",!0),z(e("div",pe,[e("div",null,"目標電子郵件地址："+v(d.value||"未知"),1)],512),[[G,d.value]])])):(m(),p("div",ee,[e("div",se,[e("div",te,[e("div",oe,[e("div",ae,[s[4]||(s[4]=e("div",{class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"}," 尚未註冊 ",-1)),e("div",le,[s[2]||(s[2]=u(" 您好，您輸入的電子郵件地址： ")),e("div",ne,v(d.value),1),s[3]||(s[3]=u(" 尚未於 Sara 系統註冊帳號。 "))]),s[5]||(s[5]=e("div",{class:"p-6 bg-white border-b border-gray-200"},[u(" 若您確定曾經註冊過："),e("br"),u(" 請檢查您輸入的電子郵件地址，"),e("br"),u(" 並點選「取消」以重新輸入。 ")],-1)),s[6]||(s[6]=e("div",{class:"p-6 bg-white border-b border-gray-200"},[u(" 若您未曾註冊："),e("br"),u(" 請點選「註冊」以進行註冊。"),e("br"),u(" 註冊即代表您同意我們的 "),e("a",{href:"https://web-tech.tw/#/privacy",class:"text-sky-500 hover:text-sky-700",target:"_blank"}," 隱私權政策 "),u("。 ")],-1)),e("div",{class:"p-6 bg-white border-b border-gray-200 text-right"},[e("button",{class:"bg-amber-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-amber-600 rounded mr-3",onClick:P}," 註冊 "),e("button",{class:"bg-white shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded",onClick:T}," 取消 ")])])])])])])),g(X,{modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=o=>l.value=o)},null,8,["modelValue"])],64))}};export{he as default};
