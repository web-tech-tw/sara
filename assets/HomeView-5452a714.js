import{r,u as w,c,o as x,a as $,b as d,t as j,d as v,F as k,e as S,f as B}from"./index-dba97ea6.js";import{_ as C,a as R}from"./ToastModal-06bfe772.js";const q={class:"flex justify-center my-8 py-16"},F={class:"flex flex-col mx-5"},I={class:"input-label text-base mb-2"},A={__name:"HomeView",setup(M){const i=r(!1),o=r(""),p=r(""),l=r(""),u=r(""),m=B(),_=w(),f=c(()=>l.value?"請輸入您的登入代碼：":"請輸入您的電子郵件地址："),g=c(()=>l.value?"例如：123456":"例如：sara@web-tech.tw"),y=c(()=>l.value?`請於您的電子郵件信箱 ${p.value} 收取登入代碼。`:""),V=async t=>{if(!t){o.value="請輸入資料";return}o.value="",i.value=!0,l.value?await h(t):await b(t),i.value=!1},b=async t=>{var s,e;try{const n=await(await m.post("tokens",{json:{email:t}})).json();n!=null&&n.session_id?(l.value=n.session_id,p.value=u.value,u.value=""):o.value="發生錯誤 (無錯誤代碼)"}catch(a){if(((s=a==null?void 0:a.response)==null?void 0:s.status)===404)sessionStorage.setItem("sara_register_email",t),_.push("/register");else{const n=((e=a==null?void 0:a.response)==null?void 0:e.status)||"無錯誤代碼";o.value=`發生錯誤 (${n})`,console.error(a.message)}}},h=async t=>{var s;try{await m.patch("tokens",{json:{session_id:l.value,code:t}}),o.value="登入成功，正在寫入憑證...",S()}catch(e){const a=((s=e==null?void 0:e.response)==null?void 0:s.status)||"無錯誤代碼";o.value=`發生錯誤 (${a})`,console.error(e.message)}};return(t,s)=>(x(),$(k,null,[d("div",q,[d("div",F,[d("label",I,j(f.value),1),v(C,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=e=>u.value=e),loading:i.value,placeholder:g.value,description:y.value,onSubmit:V},null,8,["modelValue","loading","placeholder","description"])])]),v(R,{modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=e=>o.value=e)},null,8,["modelValue"])],64))}};export{A as default};
