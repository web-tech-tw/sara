import{r as l,u as y,c as i,o as x,a as w,b as u,t as p,d as j,e as k,f as B}from"./index-e17f8973.js";import{_ as C}from"./InputModal-73614a06.js";const R={class:"flex justify-center my-8 py-16"},S={class:"flex flex-col"},V={class:"input-label text-base mb-2"},$={class:"input-label text-base mb-2 text-red-600"},A={__name:"HomeView",setup(q){const c=l(!1),t=l(""),o=l(""),d=B(),_=y(),m=i(()=>o.value?"請輸入您的登入代碼：":"請輸入您的電子郵件地址："),v=i(()=>o.value?"例如：123456":"例如：sara@web-tech.tw"),f=i(()=>o.value?"請於您的電子郵件信箱收取登入代碼。":""),h=async s=>{if(!s){t.value="請輸入資料";return}t.value="",c.value=!0,o.value?await g(s):await b(s),c.value=!1},b=async s=>{var n,a;try{const r=await(await d.post("tokens",{json:{email:s}})).json();r!=null&&r.session_id?o.value=r.session_id:t.value="發生錯誤 (無錯誤代碼)"}catch(e){if(((n=e==null?void 0:e.response)==null?void 0:n.status)===404)sessionStorage.setItem("sara_register_email",s),_.push("/register");else{const r=((a=e==null?void 0:e.response)==null?void 0:a.status)||"無錯誤代碼";t.value=`發生錯誤 (${r})`,console.error(e.message)}}},g=async s=>{var n;try{await d.patch("tokens",{json:{session_id:o.value,code:s}}),t.value="登入成功，正在寫入憑證...",k()}catch(a){const e=((n=a==null?void 0:a.response)==null?void 0:n.status)||"無錯誤代碼";t.value=`發生錯誤 (${e})`,console.error(a.message)}};return(s,n)=>(x(),w("div",R,[u("div",S,[u("label",V,p(m.value),1),u("p",$,p(t.value),1),j(C,{loading:c.value,placeholder:v.value,description:f.value,onSubmit:h},null,8,["loading","placeholder","description"])])]))}};export{A as default};
