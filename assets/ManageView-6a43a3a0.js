import{r as b,c as w,g as _,h as k,o,a as n,b as t,t as r,i as l,F as h,j as f,k as E,w as T,v as A,d as S,l as V,f as I}from"./index-2f162eac.js";const N={class:"flex justify-center my-8 py-16"},C={key:0,class:"flex flex-col mx-5 md:mx-auto"},R={class:"max-w-2xl mx-auto sm:px-6 lg:px-8"},D={key:0,class:"overflow-hidden shadow-md"},O={class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"},M={class:"p-6 bg-white border-b border-gray-200"},H={class:"p-6 bg-white border-b border-gray-200 text-right"},j={key:0,class:"p-6 bg-white border-b border-gray-200"},B={class:"list-disc ml-7"},U={key:1,class:"overflow-hidden shadow-md"},F={class:"p-6 bg-white border-b border-gray-200"},L={class:"flex rounded bg-white"},X={class:"p-6 bg-white border-b border-gray-200"},$={class:"p-6 bg-white border-gray-200 text-right"},G={key:1},q={__name:"ManageView",setup(K){const{VITE_INDEX_INTE_HOST:x}={VITE_INDEX_INTE_HOST:"https://web-tech.tw",VITE_SARA_INTE_HOST:"https://web-tech.tw/sara",VITE_SARA_RECV_HOST:"https://web-tech.tw/recv/sara",VITE_SARA_TOKEN_NAME:"unified_token",VITE_SARA_GUARD_NAME:"guard_token",BASE_URL:"/sara/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},u=b(!1),i=b({nickname:""}),s=b(null),m=I(),c=w(()=>{var a;return Array.isArray((a=s.value)==null?void 0:a.roles)&&s.value.roles.length}),g=async()=>{await m.put("users/me",{json:{nickname:i.value.nickname}}),setTimeout(()=>location.reload(),500)},p=()=>{localStorage.clear(),location.assign(x)};return _(async()=>{try{const e=await(await m.get("users/me")).json();s.value=e.profile,i.value.nickname=e.nickname}catch(a){console.warn(a.message)}}),(a,e)=>{const v=k("router-link");return o(),n("div",N,[s.value?(o(),n("div",C,[t("div",R,[u.value?(o(),n("div",U,[e[13]||(e[13]=t("div",{class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"}," 修改個人資料： ",-1)),t("div",F,[t("div",L,[e[9]||(e[9]=t("label",{class:"px-4 py-1 text-gray-600",for:"nickname"},"暱稱：",-1)),T(t("input",{id:"nickname","onUpdate:modelValue":e[1]||(e[1]=d=>i.value.nickname=d),class:"border-none bg-transparent px-4 py-1 text-gray-900 outline-none focus:outline-none",placeholder:"例如：星川 サラ",type:"text"},null,512),[[A,i.value.nickname]])])]),t("div",X,[e[11]||(e[11]=l(" 若要修改電子郵件地址，請點 ")),S(v,{class:"text-amber-900",to:"/manage/email"},{default:V(()=>e[10]||(e[10]=[l(" 此處 ")])),_:1}),e[12]||(e[12]=l(" 。 "))]),t("div",$,[t("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded mr-3",onClick:g}," 確定修改 "),t("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded",onClick:e[2]||(e[2]=d=>u.value=!1)}," 取消 ")])])):(o(),n("div",D,[t("div",O," 您好，"+r(s.value.nickname)+"，這裡是您的個人資料： ",1),t("div",M,[e[3]||(e[3]=t("span",{class:"text-gray-600"},"暱稱：",-1)),l(r(s.value.nickname),1),e[4]||(e[4]=t("br",null,null,-1)),e[5]||(e[5]=t("span",{class:"text-gray-600"},"電子郵件地址：",-1)),l(r(s.value.email),1),e[6]||(e[6]=t("br",null,null,-1)),e[7]||(e[7]=t("span",{class:"text-gray-600"},"Sara系統使用者識別碼：",-1)),l(r(s.value._id),1)]),t("div",H,[t("button",{class:"bg-amber-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-amber-600 rounded mr-3",onClick:p}," 登出 "),t("button",{class:"bg-red-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-red-600 rounded mr-3",onClick:p}," 刪除帳號 "),t("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded",onClick:e[0]||(e[0]=d=>u.value=!0)}," 修改個人資料 ")]),c.value?(o(),n("div",j,[e[8]||(e[8]=t("span",{class:"text-gray-600"},"持有權限：",-1)),t("ul",B,[(o(!0),n(h,null,f(s.value.roles,(d,y)=>(o(),n("li",{key:y},r(d),1))),128))])])):E("",!0)]))])])):(o(),n("div",G,r(s.value===null?"載入中...":"發生錯誤"),1))])}}};export{q as default};
