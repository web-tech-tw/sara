import{r as n,d as x,e as d,j as V,o as j,c as k,b as r,t as C,f as v,F as $,h as B}from"./index-723d37c4.js";import{_ as M}from"./InputModal-eaab557b.js";const R={class:"flex justify-center my-8 py-16"},S={class:"flex flex-col mx-5"},q={class:"input-label text-base mb-2"},U={__name:"ManageEmailView",setup(E){const u=n(!1),t=n(""),m=n(""),l=n(""),c=n(""),i=x(),p=B(),f=d(()=>l.value?"請輸入您的轉移代碼：":"請輸入新的電子郵件地址："),_=d(()=>l.value?"例如：12345678":"例如：sara@web-tech.tw"),b=d(()=>l.value?`請於您的電子郵件信箱 ${m.value} 收取轉移代碼。`:""),g=()=>{window.history.length?i.back():i.replace("/")},h=async o=>{if(!o){t.value="請輸入資料";return}t.value="",u.value=!0,l.value?await w(o):await y(o),u.value=!1},y=async o=>{var a;try{const s=await(await p.put("users/me/email",{json:{email:o}})).json();s!=null&&s.session_id?(l.value=s.session_id,m.value=c.value,c.value=""):t.value="發生錯誤 (無錯誤代碼)"}catch(e){const s=((a=e==null?void 0:e.response)==null?void 0:a.status)||"無錯誤代碼";t.value=`發生錯誤 (${s})`,console.error(e.message)}},w=async o=>{var a;try{await p.patch("users/me/email",{json:{session_id:l.value,code:o}}),t.value="修改成功，正在寫入憑證...",setTimeout(()=>i.replace("/manage"),500)}catch(e){const s=((a=e==null?void 0:e.response)==null?void 0:a.status)||"無錯誤代碼";t.value=`發生錯誤 (${s})`,console.error(e.message)}};return(o,a)=>{const e=V("toast-modal");return j(),k($,null,[r("div",R,[r("div",S,[r("label",q,C(f.value),1),v(M,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=s=>c.value=s),loading:u.value,placeholder:_.value,description:b.value,onSubmit:h},null,8,["modelValue","loading","placeholder","description"])])]),r("div",{class:"flex justify-center mt-5"},[r("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:g}," 取消 ")]),v(e,{modelValue:t.value,"onUpdate:modelValue":a[1]||(a[1]=s=>t.value=s)},null,8,["modelValue"])],64)}}};export{U as default};
