import{r as n,u as j,c as r,a as k,b as C,d as u,t as $,e as v,F as B,j as M}from"./index-395a3c98.js";import{_ as R}from"./InputModal-261cdbc1.js";import{_ as S}from"./ToastModal-8587db35.js";const q={class:"flex justify-center my-8 py-16"},E={class:"flex flex-col mx-5"},F={class:"input-label text-base mb-2"},I={__name:"ManageEmailView",setup(N){const i=n(!1),t=n(""),m=n(""),a=n(""),c=n(""),d=j(),p=M(),f=r(()=>a.value?"請輸入您的轉移代碼：":"請輸入新的電子郵件地址："),_=r(()=>a.value?"例如：12345678":"例如：sara@web-tech.tw"),y=r(()=>a.value?`請於新的電子郵件信箱 ${m.value} 收取轉移代碼。`:""),x=r(()=>a.value?"text":"email"),b=r(()=>a.value?"請輸入轉移代碼":"請輸入電子郵件地址"),g=()=>{window.history.length?d.back():d.replace("/")},h=async o=>{if(!o){t.value=b.value;return}t.value="",i.value=!0,a.value?await V(o):await w(o),i.value=!1},w=async o=>{var s;try{const l=await(await p.put("users/me/email",{json:{email:o}})).json();l!=null&&l.session_id?(a.value=l.session_id,m.value=c.value,c.value=""):t.value="發生錯誤 (無錯誤代碼)"}catch(e){const l=((s=e==null?void 0:e.response)==null?void 0:s.status)||"無錯誤代碼";t.value=`發生錯誤 (${l})`,console.error(e.message)}},V=async o=>{var s;try{await p.patch("users/me/email",{json:{session_id:a.value,code:o}}),t.value="修改成功，正在寫入憑證...",setTimeout(()=>d.replace("/manage"),500)}catch(e){const l=((s=e==null?void 0:e.response)==null?void 0:s.status)||"無錯誤代碼";t.value=`發生錯誤 (${l})`,console.error(e.message)}};return(o,s)=>(k(),C(B,null,[u("div",q,[u("div",E,[u("label",F,$(f.value),1),v(R,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=e=>c.value=e),loading:i.value,placeholder:_.value,description:y.value,"input-type":x.value,onSubmit:h},null,8,["modelValue","loading","placeholder","description","input-type"])])]),u("div",{class:"flex justify-center mt-5"},[u("button",{class:"flex items-center space-x-2 bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:g}," 取消 ")]),v(S,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=e=>t.value=e)},null,8,["modelValue"])],64))}};export{I as default};
