import{r as u,u as y,c as d,g as w,o as k,a as S,b as n,t as p,d as j,F as C,e as E,f as I}from"./index-e17f8973.js";import{_ as R}from"./InputModal-73614a06.js";const q={class:"flex justify-center my-8 py-16"},B={class:"flex flex-col"},V={class:"input-label text-base mb-2"},$={class:"input-label text-base mb-2 text-red-600"},A={__name:"RegisterView",props:{email:{type:String,required:!0}},setup(F){const l=u(!1),s=u(""),o=u(""),c=y(),m=I(),_=d(()=>o.value?"請輸入您的註冊代碼：":"請輸入您的暱稱："),g=d(()=>o.value?"例如：1234567":"例如：星川 サラ"),v=d(()=>o.value?"請於您的電子郵件信箱收取註冊代碼。":""),f=()=>{window.history.length?c.back():c.replace("/")},b=async e=>{if(!e){s.value="請輸入資料";return}s.value="",l.value=!0,o.value?await x(e):await h(e),l.value=!1},h=async e=>{var t;const i=sessionStorage.getItem("sara_register_email");try{const r=await(await m.post("users",{json:{email:i,nickname:e}})).json();r!=null&&r.session_id?o.value=r.session_id:s.value="發生錯誤 (無錯誤代碼)"}catch(a){const r=((t=a==null?void 0:a.response)==null?void 0:t.status)||"無錯誤代碼";s.value=`發生錯誤 (${r})`,console.error(a.message)}},x=async e=>{var i;try{await m.patch("users",{json:{session_id:o.value,code:e}}),s.value="註冊成功，正在寫入憑證...",sessionStorage.removeItem("sara_register_email"),E()}catch(t){const a=((i=t==null?void 0:t.response)==null?void 0:i.status)||"無錯誤代碼";s.value=`發生錯誤 (${a})`,console.error(t.message)}};return w(()=>{sessionStorage.getItem("sara_register_email")||c.replace("/")}),(e,i)=>(k(),S(C,null,[n("div",q,[n("div",B,[n("label",V,p(_.value),1),n("p",$,p(s.value),1),j(R,{loading:l.value,placeholder:g.value,description:v.value,onSubmit:b},null,8,["loading","placeholder","description"])])]),n("div",{class:"flex justify-center mt-5"},[n("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:f}," 取消 ")])],64))}};export{A as default};
