import{r,u as w,c as u,o as V,a as j,b as d,t as m,d as k,e as S,f as $}from"./index-55081c2f.js";import{_ as B}from"./InputModal-80d229f6.js";const C={class:"flex justify-center my-8 py-16"},R={class:"flex flex-col"},q={class:"input-label text-base mb-2"},I={class:"input-label text-base mb-2 text-red-600"},D={__name:"HomeView",setup(M){const i=r(!1),o=r(""),p=r(""),n=r(""),c=r(""),v=$(),_=w(),f=u(()=>n.value?"請輸入您的登入代碼：":"請輸入您的電子郵件地址："),b=u(()=>n.value?"例如：123456":"例如：sara@web-tech.tw"),h=u(()=>n.value?`請於您的電子郵件信箱 ${p.value} 收取登入代碼。`:""),g=async s=>{if(!s){o.value="請輸入資料";return}o.value="",i.value=!0,n.value?await x(s):await y(s),i.value=!1},y=async s=>{var a,t;try{const l=await(await v.post("tokens",{json:{email:s}})).json();l!=null&&l.session_id?(n.value=l.session_id,p.value=c.value,c.value=""):o.value="發生錯誤 (無錯誤代碼)"}catch(e){if(((a=e==null?void 0:e.response)==null?void 0:a.status)===404)sessionStorage.setItem("sara_register_email",s),_.push("/register");else{const l=((t=e==null?void 0:e.response)==null?void 0:t.status)||"無錯誤代碼";o.value=`發生錯誤 (${l})`,console.error(e.message)}}},x=async s=>{var a;try{await v.patch("tokens",{json:{session_id:n.value,code:s}}),o.value="登入成功，正在寫入憑證...",S()}catch(t){const e=((a=t==null?void 0:t.response)==null?void 0:a.status)||"無錯誤代碼";o.value=`發生錯誤 (${e})`,console.error(t.message)}};return(s,a)=>(V(),j("div",C,[d("div",R,[d("label",q,m(f.value),1),d("p",I,m(o.value),1),k(B,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=t=>c.value=t),loading:i.value,placeholder:b.value,description:h.value,onSubmit:g},null,8,["modelValue","loading","placeholder","description"])])]))}};export{D as default};
