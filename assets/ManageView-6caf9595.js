import{b as R,a as N,u as S,_ as O}from"./ToastModal-39d06dd1.js";import{G as V,b as h,d as U,o as x,c as v,a as e,t as _,A as m,w as C,l as H,F as D,H as q,q as P,h as j,I as L,k as I,r as w,J as A,K as G,g as B,B as K,C as F}from"./index-e5ace505.js";const J={class:"flex justify-center my-8 py-16"},W={key:0},z={key:1},Q={key:2,class:"flex flex-col max-w-2xl mx-auto"},X={class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"},Y={class:"px-6 py-4 bg-white border-b border-gray-200 md:flex"},Z={class:"px-3 mb-3 md:mb-0"},ee=["src","alt"],te={class:"ml-3"},se={class:"p-6 bg-white border-b border-gray-200"},oe={class:"text-center text-slate-600"},ae=["onClick"],ne={key:0,class:"p-6 bg-white border-b border-gray-200"},le={class:"list-disc ml-7"},re={__name:"ManageProfileShow",emits:["state","status"],setup(f,{emit:y}){const{VITE_HOME_INTE_HOST:a,VITE_SARA_TOKEN_NAME:r,VITE_SARA_GUARD_NAME:i}={VITE_HOME_INTE_HOST:"https://web-tech.tw",VITE_SARA_INTE_HOST:"https://web-tech.tw/sara",VITE_SARA_RECV_HOST:"https://web-tech.tw/recv/sara",VITE_SARA_TOKEN_NAME:"unified_token",VITE_SARA_GUARD_NAME:"guard_token",BASE_URL:"/sara/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},n=y,t=V({passkeys:[],isLoad:!0,isDead:!1}),d=h(()=>Array.isArray(t==null?void 0:t.roles)&&t.roles.length),u=h(()=>R()),o=h(()=>{const{avatar_hash:l}=t;return`https://api.gravatar.com/avatar/${l}?d=identicon&s=200`}),g=()=>{localStorage.removeItem(r),localStorage.removeItem(i),location.replace(a)},c=()=>{n("state",{name:"ManageProfileDelete",props:{id:t._id,nickname:t.nickname,email:t.email,roles:t.roles}})},b=()=>{n("state",{name:"ManageProfileEdit",props:{nickname:t.nickname,avatarHash:t.avatar_hash}})},s=l=>{n("state",{name:"ManagePasskeyShow",props:l})},$=async()=>{const l=S(),p=await l.post("users/me/passkeys"),{session_id:k,session_options:E}=await p.json();let T;try{T=await N({optionsJSON:E})}catch(M){console.error(M),n("status",{message:"通行金鑰新增失敗"});return}try{await l.patch("users/me/passkeys",{json:{session_id:k,credential:T}}),n("status",{message:"通行金鑰新增成功"}),setTimeout(()=>{location.reload()},1300)}catch(M){console.error(M),n("status",{message:"通行金鑰新增失敗"});return}};return U(async()=>{const l=S();try{const k=await(await l.get("users/me")).json(),{profile:E}=k;Object.assign(t,E),requestAnimationFrame(()=>{t.isLoad=!1})}catch(p){console.warn(p.message),t.isDead=!0}}),(l,p)=>(x(),v("div",J,[t.isDead?(x(),v("div",W," 發生錯誤 ")):t.isLoad?(x(),v("div",z," 載入中... ")):(x(),v("div",Q,[e("div",X," 您好，"+_(t.nickname)+"，這裡是您的個人資料： ",1),e("div",Y,[e("div",Z,[e("img",{src:o.value,alt:t.nickname,class:"rounded-full w-32 h-32 mx-auto md:w-16 md:h-16",title:"來自 Gravatar 的大頭貼"},null,8,ee)]),e("div",te,[p[0]||(p[0]=e("span",{class:"text-gray-600"},"暱稱：",-1)),m(_(t.nickname),1),p[1]||(p[1]=e("br",null,null,-1)),p[2]||(p[2]=e("span",{class:"text-gray-600"},"電子郵件地址：",-1)),m(_(t.email),1),p[3]||(p[3]=e("br",null,null,-1)),p[4]||(p[4]=e("span",{class:"text-gray-600"},"Sara 系統使用者識別碼：",-1)),m(_(t._id),1)])]),e("div",{class:"p-6 bg-white border-b border-gray-200 text-right"},[e("button",{class:"bg-amber-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-amber-600 rounded mr-3",onClick:g}," 登出 "),e("button",{class:"bg-red-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-red-600 rounded mr-3",onClick:c}," 刪除帳號 "),e("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded",onClick:b}," 修改個人資料 ")]),e("div",se,[p[6]||(p[6]=e("span",{class:"text-gray-600"},"通行金鑰：",-1)),C(e("div",oe," 尚未設定通行金鑰 ",512),[[H,!t.passkeys.length]]),e("div",null,[(x(!0),v(D,null,q(t.passkeys,(k,E)=>(x(),v("button",{key:E,class:"w-full bg-white text-sm text-slate-700 font-bold py-3 md:px-8 px-4 my-1 hover:bg-slate-300 rounded",onClick:T=>s(k)},_(k.label),9,ae))),128))]),u.value?(x(),v("button",{key:0,class:"w-full bg-white shadow-md text-sm text-slate-700 font-bold py-3 md:px-8 px-4 my-3 hover:bg-slate-300 rounded",onClick:$},[P(j(L),{class:"w-6 h-6 inline-block -mt-1 mr-2"}),p[5]||(p[5]=m(" 新增通行金鑰 "))])):I("",!0)]),d.value?(x(),v("div",ne,[p[7]||(p[7]=e("span",{class:"text-gray-600"},"持有權限烙印：",-1)),e("ul",le,[(x(!0),v(D,null,q(t.roles,(k,E)=>(x(),v("li",{key:E},_(k),1))),128))])])):I("",!0)]))]))}},ie={class:"flex justify-center my-8 py-16"},de={class:"flex flex-col max-w-2xl mx-auto"},ue={class:"max-w-2xl mx-auto sm:px-6 lg:px-8"},ce={class:"overflow-hidden shadow-md"},be={class:"p-6 bg-white border-b border-gray-200"},pe={class:"px-3 mb-3"},me=["src","alt"],ge={class:"rounded bg-white md:flex"},xe=["disabled"],ye={class:"p-6 bg-white border-gray-200 text-right"},ve=["disabled"],_e=["disabled"],we={__name:"ManageProfileEdit",props:{nickname:{type:String,required:!0},avatarHash:{type:String,required:!0}},emits:["state","status"],setup(f,{emit:y}){const a=f,r=y,i=w(!1),n=w(!1),t=V({nickname:a.nickname}),d=h(()=>i.value||n.value),u=h(()=>{const{avatarHash:$}=a;return`https://api.gravatar.com/avatar/${$}?d=identicon&s=200`}),o=()=>{r("state",{name:"ManageUpdateEmailRequest"})},g=()=>{window.open("https://gravatar.com")},c=()=>{location.reload()},b=async()=>{await S().put("users/me",{json:t}),n.value=!0,r("status",{message:"修改成功"}),setTimeout(()=>{location.reload()},1300)},s=async()=>{i.value=!0,await b(),i.value=!1};return($,l)=>(x(),v("div",ie,[e("div",de,[e("div",ue,[e("div",ce,[l[9]||(l[9]=e("div",{class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"}," 修改個人資料： ",-1)),e("div",be,[e("div",pe,[e("img",{src:u.value,alt:t.nickname,class:"rounded-full w-32 h-32 mx-auto",title:"來自 Gravatar 的大頭貼"},null,8,me)]),e("div",ge,[l[1]||(l[1]=e("label",{class:"w-full py-1 text-gray-600 md:w-16",for:"nickname"}," 暱稱： ",-1)),C(e("input",{id:"nickname","onUpdate:modelValue":l[0]||(l[0]=p=>t.nickname=p),class:"w-full border-none bg-transparent px-4 py-1 text-gray-900 outline-none rounded my-3 md:my-0 focus:ring",placeholder:"星川 サラ",type:"text",disabled:d.value},null,8,xe),[[A,t.nickname]])])]),e("div",{class:"p-6 bg-white border-b border-gray-200"},[l[2]||(l[2]=m(" 若要修改電子郵件地址，請點 ")),e("span",{class:"cursor-pointer text-sky-600 hover:text-sky-500",onClick:o}," 此處 "),l[3]||(l[3]=m(" 。 ")),l[4]||(l[4]=e("div",{class:"text-sm text-gray-600 mt-1"}," 本系統儲存你的電子郵件地址僅供識別使用，不會用於任何廣告或行銷用途。該資訊為存取本帳號的唯一識別方法，請務必使用最常用的電子郵件地址，以免遺失帳號存取權限。 ",-1))]),e("div",{class:"p-6 bg-white border-b border-gray-200"},[l[5]||(l[5]=m(" 若要修改大頭貼，須前往 ")),e("span",{class:"cursor-pointer text-sky-600 hover:text-sky-500",onClick:g}," Gravatar.com "),l[6]||(l[6]=m(" 。 ")),l[7]||(l[7]=e("div",{class:"text-sm text-gray-600 mt-1"}," 我們使用 Gravatar 服務來提供大頭貼，您可以在 Gravatar 網站上使用您的電子郵件地址註冊帳號，並上傳您的大頭貼。 ",-1)),l[8]||(l[8]=e("div",{class:"text-sm text-gray-600 mt-1"}," 本系統不會儲存您的大頭貼，而是透過去識別化技術提供對應大頭貼的圖片網址。 ",-1))]),e("div",ye,[e("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded mr-3",disabled:d.value,onClick:s}," 確定修改 ",8,ve),e("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded",disabled:d.value,onClick:c}," 取消 ",8,_e)])])])])]))}},fe={class:"flex justify-center my-8 py-16"},he={class:"flex flex-col max-w-2xl mx-auto"},ke={class:"max-w-2xl mx-auto sm:px-6 lg:px-8"},Se={class:"overflow-hidden shadow-md"},$e={class:"p-6 bg-white border-b border-gray-200"},Ee={class:"p-6"},Ce={class:"p-6"},Ae={class:"p-6 bg-white border-b border-gray-200"},Te={class:"rounded bg-white md:flex"},Me=["disabled"],De={class:"p-6 bg-white border-gray-200 text-right"},Ve=["disabled"],qe=["disabled"],Ie={__name:"ManageProfileDelete",props:{id:{type:String,required:!0},nickname:{type:String,required:!0},email:{type:String,required:!0},roles:{type:Array,required:!0}},emits:["status"],setup(f,{emit:y}){const{VITE_HOME_INTE_HOST:a}={VITE_HOME_INTE_HOST:"https://web-tech.tw",VITE_SARA_INTE_HOST:"https://web-tech.tw/sara",VITE_SARA_RECV_HOST:"https://web-tech.tw/recv/sara",VITE_SARA_TOKEN_NAME:"unified_token",VITE_SARA_GUARD_NAME:"guard_token",BASE_URL:"/sara/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},r=f,i=y,n=w(!1),t=w(!1),d=w(""),u=h(()=>n.value||t.value),o=()=>{location.reload()},g=async()=>{await S().delete("users/me"),t.value=!0,i("status",{message:"刪除成功"}),setTimeout(()=>{location.replace(a)},1300)},c=async()=>{const{value:b}=d;if(b!=="DELETE"){i("status",{message:"請輸入 DELETE 以確認刪除"});return}n.value=!0,await g(),n.value=!1};return(b,s)=>(x(),v("div",fe,[e("div",he,[e("div",ke,[e("div",Se,[s[14]||(s[14]=G('<div class="px-6 py-4 bg-white border-b border-gray-200 font-bold"> 刪除帳號 </div><div class="p-6 bg-white border-b border-gray-200 text-red-600"> ⚠️ 請注意，刪除帳號後，所有資料將無法復原。 </div><div class="p-6 bg-white border-b border-gray-200"><p class="text-amber-500"> ‼️ 刪除並非完全抹除 ‼️ </p> 本系統將保留您的「Sara 系統使用者識別碼」以供您先前曾使用的服務繼續應用，但會將您的暱稱及電子郵件地址設為無效值。<br> 這意味著，您將 <span class="text-red-600">永久喪失</span> 本帳號的存取權限，您將不再被識別為「同一個使用者」。但您的互動紀錄仍會保留在系統中作為服務參照。 <div class="my-3"> 以下是將被刪除的資料： <ul class="list-disc ml-6"><li>暱稱</li><li>電子郵件地址</li><li>您對本「Sara 系統使用者識別碼」之存取權限</li></ul></div> 在帳號刪除後，您將無法再次使用此帳號登入本系統。<br> 但您可使用相同的電子郵件地址重新註冊新帳號。 </div><div class="p-6 bg-white border-b border-gray-200 text-red-600"> 請注意，刪除帳號後，所有資料將無法復原。<br> 本操作無法撤銷，請謹慎考慮。<br> 若確定刪除，請輸入 DELETE 以確認。 </div>',4)),e("div",$e,[s[11]||(s[11]=m(" 將被刪除的帳號資訊如下： ")),e("div",Ee,[s[1]||(s[1]=e("span",{class:"text-gray-600"},"暱稱：",-1)),m(_(r.nickname),1),s[2]||(s[2]=e("br",null,null,-1)),s[3]||(s[3]=e("span",{class:"text-gray-600"},"電子郵件地址：",-1)),m(_(r.email),1),s[4]||(s[4]=e("br",null,null,-1)),s[5]||(s[5]=e("span",{class:"text-red-600"},"（資料將會立即抹除，不會保存您的資訊）",-1))]),s[12]||(s[12]=m(" 將解除存取權限的使用者識別碼如下： ")),e("div",Ce,[s[6]||(s[6]=e("span",{class:"text-gray-600"},"Sara 系統使用者識別碼：",-1)),m(_(r.id),1),s[7]||(s[7]=e("br",null,null,-1)),s[8]||(s[8]=e("span",{class:"text-gray-600"},"Sara 系統權限烙印：",-1)),m(_(r.roles.length)+" 組",1),s[9]||(s[9]=e("br",null,null,-1)),s[10]||(s[10]=e("span",{class:"text-red-600"},"（資料仍會保留在系統中，但將無法再次使用）",-1))])]),e("div",Ae,[e("div",Te,[s[13]||(s[13]=e("label",{class:"w-full py-1 text-gray-600 md:w-16",for:"confirm"}," 刪除： ",-1)),C(e("input",{id:"confirm","onUpdate:modelValue":s[0]||(s[0]=$=>d.value=$),class:"w-full border-none bg-transparent px-4 py-1 text-gray-900 outline-none rounded my-3 md:my-0 focus:ring",placeholder:"若確定刪除，請輸入 DELETE",type:"text",disabled:u.value},null,8,Me),[[A,d.value]])])]),e("div",De,[e("button",{class:"bg-red-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-red-600 rounded mr-3",disabled:u.value,onClick:c}," 確定刪除 ",8,Ve),e("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded",disabled:u.value,onClick:o}," 取消 ",8,qe)])])])])]))}},Pe={class:"flex justify-center my-8 py-16"},Re={class:"flex flex-col max-w-2xl mx-auto"},Ne={class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"},Oe={class:"p-6 bg-white border-b border-gray-200"},Ue={__name:"ManagePasskeyShow",props:{id:{type:String,required:!0},label:{type:String,required:!0},publicKey:{type:String,required:!0},counter:{type:Number,required:!0},transports:{type:Array,required:!0},createdAt:{type:String,required:!0},updatedAt:{type:String,required:!0}},emits:["state"],setup(f,{emit:y}){const a=f,r=y,i=h(()=>{var u;return(u=a.transports)!=null&&u.length?a.transports.join("、"):"不支援"}),n=()=>{r("state",{name:"ManagePasskeyEdit",props:{id:a.id,label:a.label}})},t=()=>{r("state",{name:"ManagePasskeyDelete",props:{id:a.id,label:a.label}})},d=()=>{r("state",{name:"ManageProfileShow"})};return(u,o)=>(x(),v("div",Pe,[e("div",Re,[e("div",Ne," Passkey 通行金鑰 — "+_(a.label),1),e("div",Oe,[o[0]||(o[0]=e("span",{class:"text-gray-600"},"金鑰識別碼: ",-1)),m(_(a.id),1),o[1]||(o[1]=e("br",null,null,-1)),o[2]||(o[2]=e("span",{class:"text-gray-600"},"使用次數*: ",-1)),m(_(a.counter),1),o[3]||(o[3]=e("br",null,null,-1)),o[4]||(o[4]=e("span",{class:"text-gray-600"},"傳輸機制: ",-1)),m(_(i.value),1),o[5]||(o[5]=e("br",null,null,-1)),o[6]||(o[6]=e("span",{class:"text-gray-600"},"建立時間: ",-1)),m(_(a.createdAt),1),o[7]||(o[7]=e("br",null,null,-1)),o[8]||(o[8]=e("span",{class:"text-gray-600"},"更新時間: ",-1)),m(_(a.updatedAt),1),o[9]||(o[9]=e("br",null,null,-1))]),o[10]||(o[10]=e("div",{class:"p-6 bg-white border-b border-gray-200 text-sm text-gray-600 inline-block"},[e("span",null,"*「Passkeys 通行金鑰」並非「Security Keys 安全金鑰」，"),e("span",null,"雖 WebAuthn 2 規範曾因安全考量（重放攻擊問題）提及「Signature Counter 簽名計數器」機制。"),e("span",null,"但由於跨裝置傳輸驗證特性，因現今各家安全裝置廠商的同步技術問題因素，"),e("span",null,[m("當前絕大部分裝置"),e("b",null,"並無實作"),m("「使用次數」跨裝置計數同步機制。")]),e("span",null,"基於各項技術原因限制，本數值將永久保持為「0」。")],-1)),e("div",{class:"p-6 bg-white border-gray-200 text-right"},[e("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded mr-3",onClick:n}," 修改 "),e("button",{class:"bg-red-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-red-600 rounded mr-3",onClick:t}," 移除 "),e("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded",onClick:d}," 返回 ")])])]))}},He={class:"flex justify-center my-8 py-16"},je={class:"flex flex-col max-w-2xl mx-auto"},Le={class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"},Ge={class:"p-6 bg-white border-b border-gray-200"},Be={class:"rounded bg-white md:flex"},Ke=["disabled"],Fe={class:"p-6 bg-white border-gray-200 text-right"},Je=["disabled"],We=["disabled"],ze={__name:"ManagePasskeyEdit",props:{id:{type:String,required:!0},label:{type:String,required:!0}},emits:["status"],setup(f,{emit:y}){const a=f,r=y,i=w(!1),n=w(!1),t=V({label:a.label}),d=h(()=>i.value||n.value),u=()=>{location.reload()},o=async()=>{await S().put(`users/me/passkeys/${a.id}`,{json:t}),n.value=!0,r("status",{message:"修改成功"}),setTimeout(()=>{location.reload()},1300)},g=async()=>{i.value=!0,await o(),i.value=!1};return(c,b)=>(x(),v("div",He,[e("div",je,[e("div",Le," 修改 Passkey 通行金鑰 — "+_(a.label),1),e("div",Ge,[e("div",Be,[b[1]||(b[1]=e("label",{class:"w-full py-1 text-gray-600 md:w-16",for:"label"}," 名稱： ",-1)),C(e("input",{id:"label","onUpdate:modelValue":b[0]||(b[0]=s=>t.label=s),class:"w-full border-none bg-transparent px-4 py-1 text-gray-900 outline-none rounded my-3 md:my-0 focus:ring",placeholder:"芝麻開門",type:"text",disabled:d.value},null,8,Ke),[[A,t.label]])])]),e("div",Fe,[e("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded mr-3",disabled:d.value,onClick:g}," 確定修改 ",8,Je),e("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded",disabled:d.value,onClick:u}," 取消 ",8,We)])])]))}},Qe={class:"flex justify-center my-8 py-16"},Xe={class:"flex flex-col max-w-2xl mx-auto"},Ye={class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"},Ze={class:"p-6 bg-white border-gray-200 text-right"},et=["disabled"],tt=["disabled"],st={__name:"ManagePasskeyDelete",props:{id:{type:String,required:!0},label:{type:String,required:!0}},emits:["status"],setup(f,{emit:y}){const a=f,r=y,i=w(!1),n=w(!1),t=h(()=>i.value||n.value),d=()=>{location.reload()},u=async()=>{await S().delete(`users/me/passkeys/${a.id}`),n.value=!0,r("status",{message:"移除成功"}),setTimeout(()=>{location.reload()},1300)},o=async()=>{i.value=!0,await u(),i.value=!1};return(g,c)=>(x(),v("div",Qe,[e("div",Xe,[e("div",Ye," 移除 Passkey 通行金鑰 — "+_(a.label),1),c[0]||(c[0]=e("div",{class:"p-6 bg-white border-b border-gray-200"}," 您確定要移除此 Passkey 通行金鑰嗎？此動作無法復原。 ",-1)),e("div",Ze,[e("button",{class:"bg-red-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-red-600 rounded mr-3",disabled:t.value,onClick:o}," 確定移除 ",8,et),e("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded",disabled:t.value,onClick:d}," 取消 ",8,tt)])])]))}},ot={class:"flex justify-center my-8 py-16"},at={class:"flex flex-col max-w-2xl mx-auto"},nt={class:"max-w-2xl mx-auto sm:px-6 lg:px-8"},lt={class:"overflow-hidden shadow-md"},rt={class:"p-6 bg-white border-b border-gray-200"},it={class:"rounded bg-white md:flex"},dt=["disabled"],ut={class:"p-6 bg-white border-gray-200 text-right"},ct=["disabled"],bt=["disabled"],pt={__name:"ManageUpdateEmailRequest",emits:["state","status"],setup(f,{emit:y}){const a=y,r=w(!1),i=w(!1),n=w(""),t=h(()=>r.value||i.value),d=()=>{location.reload()},u=async g=>{const s=await(await S().put("users/me/email",{json:{email:g}})).json();i.value=!0,a("state",{name:"ManageUpdateEmailVerify",props:{sessionId:s.session_id,sessionTm:s.session_tm,sessionUa:s.session_ua,sessionIp:s.session_ip,currentMail:g}})},o=async()=>{const{value:g}=n;if(!g){a("status",{message:"請輸入新的電子郵件地址"});return}r.value=!0,await u(g),r.value=!1};return(g,c)=>(x(),v("div",ot,[e("div",at,[e("div",nt,[e("div",lt,[c[2]||(c[2]=e("div",{class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"}," 修改電子郵件地址： ",-1)),e("div",rt,[e("div",it,[c[1]||(c[1]=e("label",{class:"w-full py-1 text-gray-600 md:w-64",for:"email"}," 新的電子郵件地址： ",-1)),C(e("input",{id:"email","onUpdate:modelValue":c[0]||(c[0]=b=>n.value=b),class:"w-full border-none bg-transparent px-4 py-1 text-gray-900 outline-none rounded my-3 md:my-0 focus:ring",placeholder:"例如：sara@web-tech.tw",type:"email",disabled:t.value},null,8,dt),[[A,n.value]])])]),e("div",ut,[e("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded mr-3",disabled:t.value,onClick:o}," 確定修改 ",8,ct),e("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded",disabled:t.value,onClick:d}," 取消 ",8,bt)])])])])]))}},mt={class:"flex justify-center my-8 py-16"},gt={class:"flex flex-col max-w-2xl mx-auto"},xt={class:"max-w-2xl mx-auto sm:px-6 lg:px-8"},yt={class:"overflow-hidden shadow-md"},vt={class:"p-6 bg-white border-b border-gray-200"},_t={class:"rounded bg-white md:flex"},wt=["disabled"],ft={class:"p-6 bg-white border-gray-200 text-right"},ht=["disabled"],kt=["disabled"],St={__name:"ManageUpdateEmailVerify",props:{sessionId:{type:String,required:!0},sessionTm:{type:String,required:!0},sessionUa:{type:String,required:!0},sessionIp:{type:String,required:!0},currentMail:{type:String,required:!0}},emits:["status"],setup(f,{emit:y}){const a=f,r=y,i=w(!1),n=w(!1),t=w(""),d=h(()=>i.value||n.value),u=()=>{location.reload()},o=async c=>{await S().patch("users/me/email",{json:{session_id:a.sessionId,code:c}}),n.value=!0,r("status",{message:"修改成功"}),setTimeout(()=>{location.reload()},1300)},g=async()=>{const{value:c}=t;if(!c){r("status",{message:"請輸入轉移代碼"});return}i.value=!0,await o(c),i.value=!1};return(c,b)=>(x(),v("div",mt,[e("div",gt,[e("div",xt,[e("div",yt,[b[2]||(b[2]=e("div",{class:"px-6 py-4 bg-white border-b border-gray-200 font-bold"}," 修改電子郵件地址： ",-1)),e("div",vt,[e("div",_t,[b[1]||(b[1]=e("label",{class:"w-full py-1 text-gray-600 md:w-64",for:"code"}," 轉移代碼： ",-1)),C(e("input",{id:"code","onUpdate:modelValue":b[0]||(b[0]=s=>t.value=s),class:"w-full border-none bg-transparent px-4 py-1 text-gray-900 outline-none rounded my-3 md:my-0 focus:ring",placeholder:"例如：12345678",type:"text",disabled:d.value},null,8,wt),[[A,t.value]])])]),e("div",ft,[e("button",{class:"bg-sky-500 shadow-md text-sm text-white font-bold py-3 md:px-8 px-4 hover:bg-sky-600 rounded mr-3",disabled:d.value,onClick:g}," 確定修改 ",8,ht),e("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded",disabled:d.value,onClick:u}," 取消 ",8,kt)])])])])]))}},Ct={__name:"ManageView",setup(f){const y=w("ManageProfileShow"),a=w(null),r=w(""),i={ManageProfileShow:re,ManageProfileEdit:we,ManageProfileDelete:Ie,ManagePasskeyShow:Ue,ManagePasskeyEdit:ze,ManagePasskeyDelete:st,ManageUpdateEmailRequest:pt,ManageUpdateEmailVerify:St},n=h(()=>i[y.value]),t=({name:u,props:o})=>{y.value=u,a.value=o??{},requestAnimationFrame(()=>{window.scroll({behavior:"smooth",top:0})})},d=({message:u})=>{r.value=u};return(u,o)=>(x(),v(D,null,[(x(),B(F(n.value),K(a.value,{onState:t,onStatus:d}),null,16)),P(O,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=g=>r.value=g)},null,8,["modelValue"])],64))}};export{Ct as default};
