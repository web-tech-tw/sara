import{r as c,u as w,c as d,o as V,a as j,b as n,t as v,d as k,F as C,f as $}from"./index-55081c2f.js";import{_ as B}from"./InputModal-80d229f6.js";const M={class:"flex justify-center my-8 py-16"},R={class:"flex flex-col"},S={class:"input-label text-base mb-2"},q={class:"input-label text-base mb-2 text-red-600"},D={__name:"ManageEmailView",setup(E){const i=c(!1),o=c(""),m=c(""),l=c(""),r=c(""),u=w(),p=$(),f=d(()=>l.value?"請輸入您的轉移代碼：":"請輸入新的電子郵件地址："),_=d(()=>l.value?"例如：12345678":"例如：sara@web-tech.tw"),b=d(()=>l.value?`請於您的電子郵件信箱 ${m.value} 收取轉移代碼。`:""),h=()=>{window.history.length?u.back():u.replace("/")},g=async s=>{if(!s){o.value="請輸入資料";return}o.value="",i.value=!0,l.value?await y(s):await x(s),i.value=!1},x=async s=>{var t;try{const a=await(await p.put("users/me/email",{json:{email:s}})).json();a!=null&&a.session_id?(l.value=a.session_id,m.value=r.value,r.value=""):o.value="發生錯誤 (無錯誤代碼)"}catch(e){const a=((t=e==null?void 0:e.response)==null?void 0:t.status)||"無錯誤代碼";o.value=`發生錯誤 (${a})`,console.error(e.message)}},y=async s=>{var t;try{await p.patch("users/me/email",{json:{session_id:l.value,code:s}}),o.value="修改成功，正在寫入憑證...",setTimeout(()=>u.replace("/manage"),500)}catch(e){const a=((t=e==null?void 0:e.response)==null?void 0:t.status)||"無錯誤代碼";o.value=`發生錯誤 (${a})`,console.error(e.message)}};return(s,t)=>(V(),j(C,null,[n("div",M,[n("div",R,[n("label",S,v(f.value),1),n("p",q,v(o.value),1),k(B,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),loading:i.value,placeholder:_.value,description:b.value,onSubmit:g},null,8,["modelValue","loading","placeholder","description"])])]),n("div",{class:"flex justify-center mt-5"},[n("button",{class:"bg-white-500 shadow-md text-sm text-black font-bold py-3 md:px-8 px-4 hover:bg-slate-100 rounded mr-3",onClick:h}," 取消 ")])],64))}};export{D as default};
