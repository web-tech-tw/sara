import{A as k,E as v,w as x,v as C,a as I,b as O,d,f as P,h as N,G as j,t as V}from"./index-97f5e210.js";class T extends Error{constructor(e,t,s){const o=e.status||e.status===0?e.status:"",n=e.statusText||"",i=`${o} ${n}`.trim(),a=i?`status code ${i}`:"an unknown error";super(`Request failed with ${a}`),Object.defineProperty(this,"response",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="HTTPError",this.response=e,this.request=t,this.options=s}}class R extends Error{constructor(e){super("Request timed out"),Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="TimeoutError",this.request=e}}const f=r=>r!==null&&typeof r=="object",h=(...r)=>{for(const e of r)if((!f(e)||Array.isArray(e))&&e!==void 0)throw new TypeError("The `options` argument must be an object");return _({},...r)},S=(r={},e={})=>{const t=new globalThis.Headers(r),s=e instanceof globalThis.Headers,o=new globalThis.Headers(e);for(const[n,i]of o.entries())s&&i==="undefined"||i===void 0?t.delete(n):t.set(n,i);return t},_=(...r)=>{let e={},t={};for(const s of r)if(Array.isArray(s))Array.isArray(e)||(e=[]),e=[...e,...s];else if(f(s)){for(let[o,n]of Object.entries(s))f(n)&&o in e&&(n=_(e[o],n)),e={...e,[o]:n};f(s.headers)&&(t=S(t,s.headers),e.headers=t)}return e},U=(()=>{let r=!1,e=!1;const t=typeof globalThis.ReadableStream=="function",s=typeof globalThis.Request=="function";return t&&s&&(e=new globalThis.Request("https://empty.invalid",{body:new globalThis.ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type")),r&&!e})(),M=typeof globalThis.AbortController=="function",H=typeof globalThis.ReadableStream=="function",D=typeof globalThis.FormData=="function",A=["get","post","put","patch","head","delete"],L={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},m=2147483647,E=Symbol("stop"),B=r=>A.includes(r)?r.toUpperCase():r,F=["get","put","head","delete","options","trace"],$=[408,413,429,500,502,503,504],q=[413,429,503],g={limit:2,methods:F,statusCodes:$,afterStatusCodes:q,maxRetryAfter:Number.POSITIVE_INFINITY,backoffLimit:Number.POSITIVE_INFINITY},z=(r={})=>{if(typeof r=="number")return{...g,limit:r};if(r.methods&&!Array.isArray(r.methods))throw new Error("retry.methods must be an array");if(r.statusCodes&&!Array.isArray(r.statusCodes))throw new Error("retry.statusCodes must be an array");return{...g,...r,afterStatusCodes:q}};async function J(r,e,t){return new Promise((s,o)=>{const n=setTimeout(()=>{e&&e.abort(),o(new R(r))},t.timeout);t.fetch(r).then(s).catch(o).then(()=>{clearTimeout(n)})})}async function G(r,{signal:e}){return new Promise((t,s)=>{e&&(e.throwIfAborted(),e.addEventListener("abort",o,{once:!0}));function o(){clearTimeout(n),s(e.reason)}const n=setTimeout(()=>{e==null||e.removeEventListener("abort",o),t()},r)})}class p{static create(e,t){const s=new p(e,t),o=async()=>{if(typeof s._options.timeout=="number"&&s._options.timeout>m)throw new RangeError(`The \`timeout\` option cannot be greater than ${m}`);await Promise.resolve();let a=await s._fetch();for(const u of s._options.hooks.afterResponse){const c=await u(s.request,s._options,s._decorateResponse(a.clone()));c instanceof globalThis.Response&&(a=c)}if(s._decorateResponse(a),!a.ok&&s._options.throwHttpErrors){let u=new T(a,s.request,s._options);for(const c of s._options.hooks.beforeError)u=await c(u);throw u}if(s._options.onDownloadProgress){if(typeof s._options.onDownloadProgress!="function")throw new TypeError("The `onDownloadProgress` option must be a function");if(!H)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");return s._stream(a.clone(),s._options.onDownloadProgress)}return a},i=s._options.retry.methods.includes(s.request.method.toLowerCase())?s._retry(o):o();for(const[a,u]of Object.entries(L))i[a]=async()=>{s.request.headers.set("accept",s.request.headers.get("accept")||u);const l=(await i).clone();if(a==="json"){if(l.status===204||(await l.clone().arrayBuffer()).byteLength===0)return"";if(t.parseJson)return t.parseJson(await l.text())}return l[a]()};return i}constructor(e,t={}){if(Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"abortController",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_retryCount",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_input",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._input=e,this._options={credentials:this._input.credentials||"same-origin",...t,headers:S(this._input.headers,t.headers),hooks:_({beforeRequest:[],beforeRetry:[],beforeError:[],afterResponse:[]},t.hooks),method:B(t.method??this._input.method),prefixUrl:String(t.prefixUrl||""),retry:z(t.retry),throwHttpErrors:t.throwHttpErrors!==!1,timeout:t.timeout??1e4,fetch:t.fetch??globalThis.fetch.bind(globalThis)},typeof this._input!="string"&&!(this._input instanceof URL||this._input instanceof globalThis.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this._options.prefixUrl&&typeof this._input=="string"){if(this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this._options.prefixUrl.endsWith("/")||(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input}if(M){if(this.abortController=new globalThis.AbortController,this._options.signal){const s=this._options.signal;this._options.signal.addEventListener("abort",()=>{this.abortController.abort(s.reason)})}this._options.signal=this.abortController.signal}if(U&&(this._options.duplex="half"),this.request=new globalThis.Request(this._input,this._options),this._options.searchParams){const o="?"+(typeof this._options.searchParams=="string"?this._options.searchParams.replace(/^\?/,""):new URLSearchParams(this._options.searchParams).toString()),n=this.request.url.replace(/(?:\?.*?)?(?=#|$)/,o);(D&&this._options.body instanceof globalThis.FormData||this._options.body instanceof URLSearchParams)&&!(this._options.headers&&this._options.headers["content-type"])&&this.request.headers.delete("content-type"),this.request=new globalThis.Request(new globalThis.Request(n,{...this.request}),this._options)}this._options.json!==void 0&&(this._options.body=JSON.stringify(this._options.json),this.request.headers.set("content-type",this._options.headers.get("content-type")??"application/json"),this.request=new globalThis.Request(this.request,{body:this._options.body}))}_calculateRetryDelay(e){if(this._retryCount++,this._retryCount<this._options.retry.limit&&!(e instanceof R)){if(e instanceof T){if(!this._options.retry.statusCodes.includes(e.response.status))return 0;const s=e.response.headers.get("Retry-After");if(s&&this._options.retry.afterStatusCodes.includes(e.response.status)){let o=Number(s);return Number.isNaN(o)?o=Date.parse(s)-Date.now():o*=1e3,this._options.retry.maxRetryAfter!==void 0&&o>this._options.retry.maxRetryAfter?0:o}if(e.response.status===413)return 0}const t=.3;return Math.min(this._options.retry.backoffLimit,t*2**(this._retryCount-1)*1e3)}return 0}_decorateResponse(e){return this._options.parseJson&&(e.json=async()=>this._options.parseJson(await e.text())),e}async _retry(e){try{return await e()}catch(t){const s=Math.min(this._calculateRetryDelay(t),m);if(s!==0&&this._retryCount>0){await G(s,{signal:this._options.signal});for(const o of this._options.hooks.beforeRetry)if(await o({request:this.request,options:this._options,error:t,retryCount:this._retryCount})===E)return;return this._retry(e)}throw t}}async _fetch(){for(const e of this._options.hooks.beforeRequest){const t=await e(this.request,this._options);if(t instanceof Request){this.request=t;break}if(t instanceof Response)return t}return this._options.timeout===!1?this._options.fetch(this.request.clone()):J(this.request.clone(),this.abortController,this._options)}_stream(e,t){const s=Number(e.headers.get("content-length"))||0;let o=0;return e.status===204?(t&&t({percent:1,totalBytes:s,transferredBytes:o},new Uint8Array),new globalThis.Response(null,{status:e.status,statusText:e.statusText,headers:e.headers})):new globalThis.Response(new globalThis.ReadableStream({async start(n){const i=e.body.getReader();t&&t({percent:0,transferredBytes:0,totalBytes:s},new Uint8Array);async function a(){const{done:u,value:c}=await i.read();if(u){n.close();return}if(t){o+=c.byteLength;const l=s===0?0:o/s;t({percent:l,transferredBytes:o,totalBytes:s},c)}n.enqueue(c),await a()}await a()}}),{status:e.status,statusText:e.statusText,headers:e.headers})}}/*! MIT License Â© Sindre Sorhus */const b=r=>{const e=(t,s)=>p.create(t,h(r,s));for(const t of A)e[t]=(s,o)=>p.create(s,h(r,o,{method:t}));return e.create=t=>b(h(t)),e.extend=t=>b(h(r,t)),e.stop=E,e},K=b(),W=K,{VITE_SARA_RECV_HOST:Y,VITE_SARA_TOKEN_NAME:y,VITE_SARA_GUARD_NAME:w}={VITE_HOME_INTE_HOST:"https://web-tech.tw",VITE_SARA_INTE_HOST:"https://web-tech.tw/sara",VITE_SARA_RECV_HOST:"https://web-tech.tw/recv/sara",VITE_SARA_TOKEN_NAME:"unified_token",VITE_SARA_GUARD_NAME:"guard_token",BASE_URL:"/sara/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},X=r=>{const e=localStorage.getItem(y),t=localStorage.getItem(w);if(!e||!t)return;const s=[e,t].join("|");r.headers.set("authorization",`XARA ${s}`)},Q=(r,e,t)=>{const s=t.headers.get("x-sara-refresh");if(!s)return;const[o,n]=s.split("|",2);localStorage.setItem(y,o),localStorage.setItem(w,n)},Z=(r,e,t)=>{t.status===401&&(localStorage.removeItem(y),localStorage.removeItem(w))},ee=W.create({prefixUrl:Y,hooks:{beforeRequest:[X],afterResponse:[Q,Z]}}),ae=()=>ee,te={class:"flex items-center space-x-2"},se={class:"font-bold"},ie={__name:"ToastModal",props:{modelValue:{type:String},modelModifiers:{}},emits:["update:modelValue"],setup(r){let e;const t=k(r,"modelValue"),s=()=>{e&&clearTimeout(e),t.value=""};return v(t,()=>{t.value&&(e=setTimeout(s,3e3))}),(o,n)=>x((I(),O("button",{type:"button",class:"fixed right-2 lg:right-24 top-24 z-50 rounded-md px-4 py-2 text-white transition bg-amber-500 hover:bg-amber-600 animate-fade",onClick:s},[d("div",te,[d("span",null,[P(N(j),{class:"h-5 w-5"})]),d("span",se,V(t.value),1)])],512)),[[C,t.value]])}};export{ie as _,ae as u};
